CREATE OR REPLACE PROCEDURE ERP.SYS_USER_UPD
/*
	Created by	:	Truong Trung L?i 
	Date		:	18/07/2012
	Description	:	C?p nh?t thông tin Ngu?i dùng 
*/
(
	v_USERNAME IN SYS_USER.USERNAME%TYPE,
	v_PASSWORD IN SYS_USER.PASSWORD%TYPE,
	v_FULLNAME IN SYS_USER.FULLNAME%TYPE,
	v_FIRSTNAME IN SYS_USER.FIRSTNAME%TYPE,
	v_LASTNAME IN SYS_USER.LASTNAME%TYPE,
	v_GENDER IN SYS_USER.GENDER%TYPE,
	v_BIRTHDAY IN SYS_USER.BIRTHDAY%TYPE,
	v_EMAIL IN SYS_USER.EMAIL%TYPE,
	v_PHONENUMBER IN SYS_USER.PHONENUMBER%TYPE,
	v_MOBI IN SYS_USER.MOBI%TYPE,
	v_ADDRESS IN SYS_USER.ADDRESS%TYPE,
	v_DEPARTMENTID IN SYS_USER.DEPARTMENTID%TYPE,
	v_POSITIONID IN SYS_USER.POSITIONID%TYPE,
	v_AREAID IN SYS_USER.AREAID%TYPE,
	v_DESCRIPTION IN SYS_USER.DESCRIPTION%TYPE,
	v_BANKACCOUNTID IN SYS_USER.BANKACCOUNTID%TYPE,
	v_IDCARD IN SYS_USER.IDCARD%TYPE,
	v_BEGINWORKDATE IN SYS_USER.BEGINWORKDATE%TYPE,
	v_WORKSTOREID IN SYS_USER.WORKSTOREID%TYPE,
	v_SIGNATUREPICTURE IN SYS_USER.SIGNATUREPICTURE%TYPE,
	v_DEFAULTPICTUREURL IN SYS_USER.DEFAULTPICTUREURL%TYPE,
	v_ISGROUPUSER IN SYS_USER.ISGROUPUSER%TYPE,
	v_ISACTIVE IN SYS_USER.ISACTIVE%TYPE,
	v_ISSYSTEM IN SYS_USER.ISSYSTEM%TYPE,
	v_UPDATEDUSER IN SYS_USER.UPDATEDUSER%TYPE,
	v_CERTIFICATESTRING IN SYS_USER_LOG.CERTIFICATESTRING%TYPE,
	v_USERHOSTADDRESS IN SYS_USER_LOG.USERHOSTADDRESS%TYPE,
	v_LOGINLOGID IN SYS_USER_LOG.LOGINLOGID%TYPE,
  v_ISAUTOADDCUMUTIMEOFFDAYS IN SYS_USER.ISAUTOADDCUMULATIONTIMEOFFDAYS%TYPE DEFAULT 0,
  v_DEFAULTPICTUREFILEID IN SYS_USER.DEFAULTPICTUREFILEID%TYPE DEFAULT NULL,
  v_SIGNATUREPICTUREFILEID IN SYS_USER.SIGNATUREPICTUREFILEID%TYPE DEFAULT NULL,
  V_WORKINGPOSITIONID IN SYS_USER.WORKINGPOSITIONID%TYPE DEFAULT 0,
  v_ISREALSTAFF IN SYS_USER.ISREALSTAFF%TYPE
) 
AS
BEGIN
	UPDATE SYS_USER
	SET
		PASSWORD	= v_PASSWORD,
		FULLNAME	= v_FULLNAME,
		FIRSTNAME	= v_FIRSTNAME,
		LASTNAME	= v_LASTNAME,
		GENDER	= v_GENDER,
		BIRTHDAY	= v_BIRTHDAY,
		EMAIL	= v_EMAIL,
		PHONENUMBER	= v_PHONENUMBER,
		MOBI	= v_MOBI,
		ADDRESS	= v_ADDRESS,
		DEPARTMENTID	= v_DEPARTMENTID,
		POSITIONID	= v_POSITIONID,
		AREAID	= v_AREAID,
		DESCRIPTION	= v_DESCRIPTION,
		BANKACCOUNTID	= v_BANKACCOUNTID,
		IDCARD	= v_IDCARD,
		BEGINWORKDATE	= v_BEGINWORKDATE,
		WORKSTOREID	= v_WORKSTOREID,
		SIGNATUREPICTURE	= v_SIGNATUREPICTURE,
		DEFAULTPICTUREURL	= v_DEFAULTPICTUREURL,
		ISGROUPUSER	= v_ISGROUPUSER,
		ISACTIVE	= v_ISACTIVE,
		ISSYSTEM	= v_ISSYSTEM,
		UPDATEDUSER	= v_UPDATEDUSER,
		UPDATEDDATE	= SYSDATE,
    ISAUTOADDCUMULATIONTIMEOFFDAYS = v_ISAUTOADDCUMUTIMEOFFDAYS,
    DEFAULTPICTUREFILEID = V_DEFAULTPICTUREFILEID,
    SIGNATUREPICTUREFILEID = V_SIGNATUREPICTUREFILEID,
    WORKINGPOSITIONID=V_WORKINGPOSITIONID,
    ISREALSTAFF =  v_ISREALSTAFF
	WHERE
		USERNAME = v_USERNAME
;
	INSERT
	INTO SYS_USER_LOG
	(
		USERNAME,
		PASSWORD,
		FULLNAME,
		FIRSTNAME,
		LASTNAME,
		GENDER,
		BIRTHDAY,
		EMAIL,
		PHONENUMBER,
		MOBI,
		ADDRESS,
		DEPARTMENTID,
		POSITIONID,
		AREAID,
		DESCRIPTION,
		BANKACCOUNTID,
		IDCARD,
		BEGINWORKDATE,
		WORKSTOREID,
		SIGNATUREPICTURE,
		DEFAULTPICTUREURL,
		ISGROUPUSER,
		ISACTIVE,
		ISSYSTEM,
		UPDATEDUSER,
		UPDATEDDATE,
		LOGTYPE,
		USERHOSTADDRESS,
		CERTIFICATESTRING,
		LOGINLOGID,
    ISAUTOADDCUMULATIONTIMEOFFDAYS,
    DEFAULTPICTUREFILEID ,
    SIGNATUREPICTUREFILEID,
    WORKINGPOSITIONID,
    ISREALSTAFF 
	)
	VALUES
	(
		v_USERNAME,
		v_PASSWORD,
		v_FULLNAME,
		v_FIRSTNAME,
		v_LASTNAME,
		v_GENDER,
		v_BIRTHDAY,
		v_EMAIL,
		v_PHONENUMBER,
		v_MOBI,
		v_ADDRESS,
		v_DEPARTMENTID,
		v_POSITIONID,
		v_AREAID,
		v_DESCRIPTION,
		v_BANKACCOUNTID,
		v_IDCARD,
		v_BEGINWORKDATE,
		v_WORKSTOREID,
		v_SIGNATUREPICTURE,
		v_DEFAULTPICTUREURL,
		v_ISGROUPUSER,
		v_ISACTIVE,
		v_ISSYSTEM,
		v_UPDATEDUSER,
		SYSDATE,
		2,
		v_USERHOSTADDRESS,
		v_CERTIFICATESTRING,
		v_LOGINLOGID,
    v_ISAUTOADDCUMUTIMEOFFDAYS,
    v_DEFAULTPICTUREFILEID ,
    v_SIGNATUREPICTUREFILEID,
    V_WORKINGPOSITIONID,
    v_ISREALSTAFF 
	);
	
END;
/