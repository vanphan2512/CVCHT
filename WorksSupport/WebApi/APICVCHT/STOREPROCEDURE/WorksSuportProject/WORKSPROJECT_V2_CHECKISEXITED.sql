-- Script was generated by Devart dbForge Studio for Oracle, Version 3.1.260.0
-- Product home page: http://www.devart.com/dbforge/oracle/studio
-- Script date 6/23/2017 12:58:50 PM
-- Server version: Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production With the Partitioning, OLAP, Data Mining and Real Application Testing options
-- Client version: 

CREATE OR REPLACE PROCEDURE ERP.WORKSPROJECT_V2_CHECKISEXITED
/*	CREATED BY	:	NGUYEN VAN HUAN
	DATE		:	21.6.2017
	DESCRIPTION	:	KIEM TRA TEN TRUNG NHAU 
*/
(	
  V_WORKSSUPPORTPROJECTID IN EO_WORKSSUPPORTPROJECT.WORKSSUPPORTPROJECTID%TYPE,
	V_WORKSSUPPORTPROJECTNAME IN EO_WORKSSUPPORTPROJECT.WORKSSUPPORTPROJECTNAME%TYPE,	
  V_ORDERINDEX IN EO_WORKSSUPPORTPROJECT.ORDERINDEX%TYPE,		
	V_OUT OUT SYS_REFCURSOR
) 
AS
 T_CHECK_NAME NUMBER := 0;
 T_CHECK_ORDER NUMBER := 0;
BEGIN

  BEGIN
    SELECT 1 INTO T_CHECK_NAME
    FROM EO_WORKSSUPPORTPROJECT EW
    WHERE WORKSSUPPORTPROJECTNAME = V_WORKSSUPPORTPROJECTNAME
      AND WORKSSUPPORTPROJECTID <> V_WORKSSUPPORTPROJECTID
      AND ISDELETED =0
      AND ROWNUM = 1;    
    EXCEPTION WHEN OTHERS THEN T_CHECK_NAME := 0;

  END; 



   BEGIN
    SELECT 1 INTO T_CHECK_ORDER
    FROM EO_WORKSSUPPORTPROJECT EW
    WHERE (V_ORDERINDEX > 0 AND ORDERINDEX = V_ORDERINDEX)
      AND WORKSSUPPORTPROJECTID <> V_WORKSSUPPORTPROJECTID
      AND ISDELETED =0
      AND ROWNUM = 1;    
    EXCEPTION WHEN OTHERS THEN T_CHECK_ORDER := 0;

  END; 
      
   -- RETURN TABLE
  OPEN V_OUT FOR
    SELECT T_CHECK_NAME AS WORKSSUPPORTPROJECTNAME, T_CHECK_ORDER AS ORDERINDEX
      FROM dual d;
  RETURN;    


END;
/