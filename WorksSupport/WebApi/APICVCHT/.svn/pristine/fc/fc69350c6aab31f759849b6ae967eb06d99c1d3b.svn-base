-- Script was generated by Devart dbForge Studio for Oracle, Version 3.1.260.0
-- Product home page: http://www.devart.com/dbforge/oracle/studio
-- Script date 6/23/2017 1:01:07 PM
-- Server version: Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production With the Partitioning, OLAP, Data Mining and Real Application Testing options
-- Client version: 

CREATE OR REPLACE PROCEDURE ERP.WORKSSUPORTPROJECT_V2_DEL
/*
	Created by	:	Nguy?n Van Ph?n 
	Date		:	09/06/2017
	Description	:	Xóa thông tin d? án
*/
(
	v_WORKSSUPPORTPROJECTID IN EO_WORKSSUPPORTPROJECT.WORKSSUPPORTPROJECTID%TYPE,
	v_DELETEDUSER IN EO_WORKSSUPPORTPROJECT.DELETEDUSER%TYPE,
  v_CERTIFICATESTRING IN EO_WORKSSUPPORTPROJECT_LOG.CERTIFICATESTRING%TYPE,
	v_USERHOSTADDRESS IN EO_WORKSSUPPORTPROJECT_LOG.USERHOSTADDRESS%TYPE,
	v_LOGINLOGID IN EO_WORKSSUPPORTPROJECT_LOG.LOGINLOGID%TYPE
)
AS
BEGIN
	UPDATE EO_WORKSSUPPORTPROJECT
	SET
		ISDELETED = 1,
		DELETEDDATE = SYSDATE,
		DELETEDUSER = v_DELETEDUSER
	WHERE
		WORKSSUPPORTPROJECTID = v_WORKSSUPPORTPROJECTID;
    INSERT
	INTO EO_WORKSSUPPORTPROJECT_LOG
	(
		WORKSSUPPORTPROJECTID,
		WORKSSUPPORTPROJECTNAME,
		WORKSSUPPORTTYPEID,
		DESCRIPTION,
		ORDERINDEX,
		ISACTIVE,
		ISSYSTEM,
		UPDATEDUSER,
		UPDATEDDATE,
		LOGTYPE,
		USERHOSTADDRESS,
		CERTIFICATESTRING,
		LOGINLOGID

	)
  SELECT
		WORKSSUPPORTPROJECTID,
		WORKSSUPPORTPROJECTNAME,
		WORKSSUPPORTTYPEID,
		DESCRIPTION,
		ORDERINDEX,
		ISACTIVE,
		ISSYSTEM, 
		v_DELETEDUSER,
		UPDATEDDATE,
    3,
		v_USERHOSTADDRESS,
		v_CERTIFICATESTRING,
		v_LOGINLOGID

    FROM 
      EO_WORKSSUPPORTPROJECT
    WHERE 
      WORKSSUPPORTPROJECTID = v_WORKSSUPPORTPROJECTID;
END;
/