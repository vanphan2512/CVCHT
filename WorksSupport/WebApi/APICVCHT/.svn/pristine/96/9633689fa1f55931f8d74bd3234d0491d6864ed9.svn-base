CREATE OR REPLACE PROCEDURE     WORKSSUPPORT_WF_V2_SEL
/*
	CREATED BY	:	LÝÕNG TRUNG NHÂN 
	DATE		:	19/06/2017
	DESCRIPTION	:	N?P THÔNG TIN TI?N D? CÔNG VI?C C?N H? TR? 
*/
(	
	V_WORKSSUPPORTID IN EO_WORKSSUPPORT_WORKFLOW.WORKSSUPPORTID%TYPE,	
	V_OUT OUT SYS_REFCURSOR
) 
AS
BEGIN
    OPEN V_OUT FOR
	SELECT
    -- GET WORKSUPPORTSTEPNAME
    (
        SELECT
            EWORKFLOW.WORKSSUPPORTSTEPNAME
        FROM
            EO_WORKSSUPPORTTYPE_WORKFLOW EWORKFLOW
        WHERE
            EWORKFLOW.WORKSSUPPORTSTEPID = WORKFLOW.WORKSSUPPORTSTEPID
    ) AS WORKSSUPPORTSTEPNAME,
        
         -- GET STATUS NAME
    (
        SELECT
            EO_WORKSSUPPORTSTATUS.WORKSSUPPORTSTATUSNAME
        FROM
            EO_WORKSSUPPORTSTATUS
            INNER JOIN EO_WORKSSUPPORTTYPE_WORKFLOW ON EO_WORKSSUPPORTSTATUS.WORKSSUPPORTSTATUSID = EO_WORKSSUPPORTTYPE_WORKFLOW.WORKSSUPPORTSTATUSID
        WHERE
            EO_WORKSSUPPORTTYPE_WORKFLOW.WORKSSUPPORTSTEPID = WORKFLOW.WORKSSUPPORTSTEPID
    ) AS WORKSSUPPORTSTATUSNAME,
        -- GET USER NAME.
    WORKFLOW.ISPROCESS,
    (
        SELECT
            SYS_USER.FULLNAME
        FROM
            SYS_USER
        WHERE
            SYS_USER.USERNAME = WORKFLOW.UPDATEDUSER
    ) AS FULLNAME,
    WORKFLOW.NOTE,
    WORKFLOW.WORKSSUPPORTDATE
FROM
    EO_WORKSSUPPORT_WORKFLOW WORKFLOW
WHERE
    WORKSSUPPORTID = V_WORKSSUPPORTID
;
END;
